# 요구사항 정의서

## 1. 프로젝트 개요

- **프로젝트명**: 콘서트 예약 서비스
- **프로젝트 목적**: 다수의 사용자에게 공정한 대기열과 동시성 문제를 해결한 좌석 예약 및 결제 서비스를 제공하는 시스템.

---

## 2. 시스템 범위

- **대상 시스템**: 좌석 예약, 잔액 충전, 결제 및 대기열 관리
- **제약 조건**
    - 다수의 인스턴스에서 동작 가능해야 함.
    - 동시성 문제를 방지하고 데이터 일관성을 유지해야 함.
    - 공정한 대기열 및 좌석 배정을 보장해야 함.
- **제외 조건**
    - 사용자 인증 처리는 인증서비스 혹은 gateway 에서 처리한다는 가정하에 프로젝트를 진행.

---

## 3. 주요 기능 요구사항

| ID   | 기능명               | 설명                                           |
|------|-------------------|----------------------------------------------|
| F-01 | 유저 토큰 발급 API      | 유저 식별용 토큰 발급 및 대기열 관리 기능 제공                  |
| F-02 | 예약 가능 날짜 / 좌석 API | 예약 가능 날짜와 해당 날짜의 좌석 목록 조회                    |
| F-03 | 좌석 예약 요청 API      | 날짜와 좌석 번호를 입력받아 좌석을 임시 배정하며, 5분 내 결제가 없으면 해제 |
| F-04 | 잔액 충전 / 조회 API    | 유저의 잔액을 충전 및 조회                              |
| F-05 | 결제 API            | 결제 완료 처리 및 좌석 소유권 배정 및 대기열 토큰 만료 처리          |

---

## 4. 비기능 요구사항

| ID    | 요구사항명     | 설명                                        |
|-------|-----------|-------------------------------------------|
| NF-01 | 동시성 문제 해결 | 다수의 사용자가 요청해도 좌석 중복 배정 방지                 |
| NF-02 | 대기열 공정성   | 요청 순서에 따라 공정하게 대기열 제공                     |
| NF-03 | 확장성       | 수평적 확장을 고려한 시스템 설계                        |
| NF-04 | 단위 테스트 작성 | 모든 기능 및 제약 사항에 대해 단위 테스트를 작성              |
| NF-05 | 통합 테스트 작성 | 통합 테스트가 필요한 부분에 대해서 통합테스트 작성              |
| NF-06 | 예상 트래픽 규모 | - 최대 10,000명의 동시 사용자를 처리 가능해야 함.          |
|       |           | - 초당 1,000개의 API 요청을 처리할 수 있어야 함.         |
|       |           | - 대기열 요청이 최대 5,000명 이상일 경우에도 공정성을 유지해야 함. |

---

## 5. 사용자 요구사항

### 시나리오 1: 대기열을 통한 좌석 예약

1. 사용자는 유저 토큰 발급 API를 호출하여 대기열에 등록합니다.
2. 대기열 순서에 따라 예약 가능 좌석 정보를 예약 가능날짜/좌석 API를 호출해 조회합니다.
3. 좌석 예약 요청 API를 호출해 좌석을 임시 배정받습니다.
4. 5분 내에 결제 API를 통해 결제를 완료합니다.
5. 결제가 완료되면 좌석의 소유권이 유저에게 배정됩니다.

### 시나리오 2: 잔액 충전 및 조회

1. 사용자는 잔액 충전 API를 호출해 금액을 충전합니다.
2. 잔액 조회 API를 호출해 현재 잔액을 확인합니다.
3. 충전된 금액으로 결제를 진행합니다.

---

## 6. 데이터 요구사항

- **필수 데이터**
    - 유저 정보: 유저 ID, 잔액, 대기열 정보
    - 좌석 정보: 좌석 번호, 예약 상태, 임시 배정 시간
    - 결제 정보: 결제 ID, 금액, 상태

- **데이터 정책**
    - 대기열 데이터는 순서를 보장하도록 처리.
    - 예약 좌석 데이터는 동시성 이슈를 고려해 일관성을 유지.
